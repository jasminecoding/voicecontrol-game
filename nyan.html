<html>
	<head>
		<script src="https://cdn.jsdelivr.net/npm/p5@1.3.0/lib/p5.js"></script>
		<script src="../lib/p5.speech.js"></script>
	</head>
	<body>
		<h2 style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">Voice Control Game - Say "up" to move up. Say "down" to move down.</h2>
		<div>Choose your character: 
			<a href="nyan.html"><button>Nyan Cat</button></a>
			<a href="index.html"><button>Pikachu</button></a>
		</div>
		<br>
		<canvas id="c" width="700" height="700"></canvas>
		
	</body>
</html>
<script>

	
	let myRec = new p5.SpeechRec();
	myRec.continuous = true;
	myRec.interimResults = true;
	myRec.onResult = parseResult;
	myRec.start();


	function parseResult() {
		let word = myRec.resultString.split(' ').pop(); // get most recent word

		if (word === 'up') {
			delta = 5;
		} else if (word === 'down') {
			delta = -5;
		} 
	
		console.log(word);
	}

	

	/*****************/



	let canvasSize = 700;

	

	const player = new Image();
	player.src = '/images/cat3.png';

	let playerSize = 70;
	let playerX = 0;
	let playerY = canvasSize / 2;
	let delta = 0;

	let pipeWidth = 90;
	let pipeGap = canvasSize / 2;
	let pipeX = canvasSize;
	let topPipeBottomY = 75;

	let gravity = 0.1;

	let aspectRatio = 1.5;

	let interval = 30;

	let context = c.getContext('2d');

	c.onclick = () => (delta = 5);

	

	const backgroundImage = new Image();
	backgroundImage.src = '/images/space.png';
	backgroundImage.onload = () => {
  	setInterval(() => {

		context.drawImage(backgroundImage, 0, 0, canvasSize, canvasSize);
		context.drawImage(player, playerX, playerY, playerSize * aspectRatio, playerSize);

		playerY -= delta -= gravity;

		pipeX -= 5;

		if (pipeX < -pipeWidth) {
			pipeX = canvasSize;
			topPipeBottomY = pipeGap * Math.random();
		}

		context.fillStyle = '#00914e';
		context.fillRect(pipeX, 0, pipeWidth, topPipeBottomY);

		let bottomY = topPipeBottomY + pipeGap;
		context.fillRect(pipeX, bottomY, pipeWidth, canvasSize);

		let hitPipe =
			(playerY < topPipeBottomY || playerY > bottomY) &&
			pipeX < playerSize * aspectRatio;

		if (hitPipe || playerY > canvasSize) {
			delta = 0;
			playerY = canvasSize / 2;
			pipeX = canvasSize;
		}
	
	}, interval);}




	
</script>
